{
    "policy": {
        "Statement": [
            {
                "Action": [
                    "iam:CreateUser",
                    "iam:CreateAccessKey"
                ],
                "Condition": {
                    "ArnNotLike": {
                        "aws:PrincipalARN": "arn:aws:iam::*:role/aws-reserved/sso.amazonaws.com/*/AWSReservedSSO_AdministratorAccess_*"
                    }
                },
                "Effect": "Deny",
                "Resource": [
                    "*"
                ],
                "Sid": "DenyIAMUserANDAccessKeyCreation"
            },
            {
                "Action": [
                    "ec2:AttachInternetGateway",
                    "ec2:CreateInternetGateway",
                    "ec2:CreateEgressOnlyInternetGateway",
                    "ec2:CreateNatGateway",
                    "ec2:CreateVpcPeeringConnection",
                    "ec2:AcceptVpcPeeringConnection",
                    "globalaccelerator:Create*",
                    "globalaccelerator:Update*"
                ],
                "Condition": {
                    "ArnNotLike": {
                        "aws:PrincipalARN": "arn:aws:iam::*:role/aws-reserved/sso.amazonaws.com/*/AWSReservedSSO_AdministratorAccess_*"
                    }
                },
                "Effect": "Deny",
                "Resource": "*",
                "Sid": "DenyMakingVPCsInternetAccessible"
            },
            {
                "Action": "ec2:RunInstances",
                "Condition": {
                    "Bool": {
                        "ec2:AssociatePublicIpAddress": "true"
                    }
                },
                "Effect": "Deny",
                "Resource": "arn:aws:ec2:*:*:network-interface/*",
                "Sid": "denyOnRunInstance"
            },
            {
                "Action": "ec2:AssociateAddress",
                "Effect": "Deny",
                "Resource": "*",
                "Sid": "denyAssociation"
            },
            {
                "Action": "rds:CreateDBCluster",
                "Condition": {
                    "Bool": {
                        "rds:StorageEncrypted": "false"
                    }
                },
                "Effect": "Deny",
                "Resource": "*",
                "Sid": "requireEncryptionAurora"
            },
            {
                "Action": "rds:CreateDBInstance",
                "Condition": {
                    "Bool": {
                        "rds:StorageEncrypted": "false"
                    },
                    "ForAnyValue:StringEquals": {
                        "rds:DatabaseEngine": [
                            "mariadb",
                            "mysql",
                            "oracle-ee",
                            "oracle-se2",
                            "oracle-se1",
                            "oracle-se",
                            "postgres",
                            "sqlserver-ee",
                            "sqlserver-se",
                            "sqlserver-ex",
                            "sqlserver-web"
                        ]
                    }
                },
                "Effect": "Deny",
                "Resource": "*",
                "Sid": "requireEncryptionOtherRds"
            }
        ],
        "Version": "2012-10-17"
    },
    "description": "This SCP has policy statements to restrict VPC and EC2 baselining actions in multiple OUs of the AWS Org. "
}